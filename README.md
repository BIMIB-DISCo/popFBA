- ‘coreHMR.xml’ is the SBML for the metabolic model used in Damiani et al. 
- ‘popFBA.m’ is the MATLAB function to perform Linear Optimisation on a population model composed of Npops clones of a given SBML model as described in Damiani et al. 
- ‘createPopModel.m’ is the function called by popFBA that returns a population model structure from a metabolic model structure


coreHMR.xml
————————————————————————————————————————————————
The exchange reactions are in the form of: metabolite[s]  <=>  ''
The uptake/secretion reactions are in the form of: metabolite_in[c] <=> metabolite_out[s]
The internal reactions are in the form of: reagent[compartment] <=> product[compartment]


popFBA
————————————————————————————————————————————————
[popModel, singleModel, optFlux] = popFBA(nameSBML, nameExRxns, nameCoopRxn, nPop, CharExtComp, otherFeat, rxnsFeat, metsFeat)

popFBA returns a Matlab structure for the input SBML model (singleModel) and for the created population model (popModel) and the solution of the FBA problem for the popModel.
see Matlab help for more details on function arguments.


USAGE EXAMPLE:
[modelPop, modelSingle, fluxese] = popFBA('namefile.xml', nameExRxns, nameCoopRxn, 's', 10, <otherFeat>, <rxnsFeat>, <metsFeat>)

where

nameExRxns = { ...
    'Ex_biomass',...
    'Ex_glucose',...
    'Ex_O2',...
    'Ex_glutamine',...
    'Ex_folate',...
    'Ex_lactate',...
    'Ex_urea',...
    'Ex_glutamate',...
    'Ex_NH3',...
    'Ex_H2O',...
    'Ex_Hs',...
    'Ex_putrescines',...
    'Ex_arginines',...
    'Ex_guanidinoacetatec',...
    'Ex_mercaptopyruvatec',...
    'Ex_phenylpyruvatec',...
    'Ex_4methylthio2oxobutanoicacidc',...
    'Ex_4methyl2oxopentanoatec',...
    'Ex_2oxo3methylvaleratec',...
    'Ex_citratec',...
    'Ex_CO2c',...
    'Ex_Pi',...
    'Ex_10formylTHFm'};
	
nameCoopRxn = { ...
    'UptakeGlucose',...
    'LactateExchange',...
    'Ex_H',...
    'UptakeOxygen',...
    'AQP6',...
    'TransportCyNH3',...
    'UptakeGlutamine',...
    'DemandGlutamate',...
    'UptakeGlutamate',...
    'UptakeArginine',...
    'Ex_putrescine',...
    'SLC14A2',...
    'UptakeFolate',...
    'biomass_synthesis',...
    'GCK_HKDC1_HK1_ADPGK_HK2_HK3'};

and 's' identify the tumor environmental compartment


The set nameExRxns will be unchanged.

The set nameCoopRxn will be cloned n = Npops times, as in the examples below: 
metabolite_in_0[c] <=> metabolite_out[s], 
metabolite_in_1[c] <=> metabolite_out[s], 
...,  
metabolite_in_(n-1)[c] <=> metabolite_out[s]

all remaining internal reactions will be cloned n = Npops time, as in the examples below: 
reagent_0[compartment] <=> product_0[compartment],
reagent_1[compartment] <=> product_1[compartment],
...,
reagent_(n-1)[compartment] <=> product_(n-1)[compartment].

If an external micro environment (s) is not already included in the single model, the cooperation reactions only should be indicated (no Exchange reactions).
The algorithm will create exchange reactions for the metabolites involved in the cooperation reactions as in the example below: 
from metabolite_in[c] <=> '' to metabolite_in_0[c] <=> metabolite_out[s];metabolite_in_1[c] <=> metabolite_out[s] and so on; and metabolite[s]  <=>  ''

	
	
OPTIONAL ARGUMENTS
otherFeat = {'genes','modelVersion'};

rxnsFeat = {'rev','c','lb','ub','rules','grRules','rxnNames'};

metsFeat = {'metNames','metCharge','metCHEBIID','metKEGGID','b'};

Only the fields indicated will be cloned in the popModel

